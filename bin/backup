#!/usr/bin/env node

var program = require('commander');
var baserequire = require('base-require');
var locator = baserequire('src/backupper/backupperLocator');

/**
 * @param {string} playlistId
 */
function handleCommand(playlistId) {
    locator.getBackupperManager().getQueueBackupper().run(playlistId)
        .then(function (errors) {
            if (errors && errors.length > 0) {
                console.log('Errors:', errors);
            }
            console.log('Finished!');
            process.exit(0);
        })
        .catch(function (err) {
            console.log('Error!', err);
            process.exit(1);
        });
}

program
    .version('0.0.1')
    .description('Create backup jobs for all videos in a Youtube playlist')
    .arguments('backup <playlist-id>')
    .action(handleCommand)
    .parse(process.argv);
